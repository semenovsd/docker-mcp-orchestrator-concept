# Конфигурация Cursor-Claude Code Bridge MCP Server

bridge:
  # ============================================
  # Claude Code API настройки
  # ============================================
  claude_code:
    # API ключ Anthropic (можно также через переменную окружения ANTHROPIC_API_KEY)
    api_key: "${ANTHROPIC_API_KEY}"
    
    # Базовый URL API (по умолчанию используется официальный)
    base_url: "https://api.anthropic.com"
    
    # Модель Claude для использования
    # Доступные модели:
    # - claude-3-5-sonnet-20241022 (рекомендуется)
    # - claude-3-opus-20240229
    # - claude-3-sonnet-20240229
    model: "claude-3-5-sonnet-20241022"
    
    # Максимальное количество токенов в ответе
    max_tokens: 4096
    
    # Температура для генерации (0.0 - 1.0)
    # Более низкая температура = более детерминированные ответы
    temperature: 0.7
    
    # Системный промпт для Claude Code (путь к файлу)
    system_prompt_path: "prompts/claude_code_orchestrator.md"
  
  # ============================================
  # Настройки запросов
  # ============================================
  request:
    # Таймаут запроса в секундах
    timeout: 300  # 5 минут
    
    # Количество попыток при ошибке
    retry_attempts: 3
    
    # Задержка между попытками (секунды)
    retry_delay: 2
    
    # Экспоненциальная задержка (умножает задержку на номер попытки)
    exponential_backoff: true
    
    # Максимальный размер запроса (символов)
    max_request_size: 10000
    
    # Максимальное количество требований в запросе
    max_requirements: 50
  
  # ============================================
  # Настройки сессий
  # ============================================
  session:
    # Время жизни сессии в секундах (TTL)
    ttl: 3600  # 1 час
    
    # Максимальное количество одновременных сессий
    max_sessions: 100
    
    # Интервал очистки истекших сессий (секунды)
    cleanup_interval: 300  # 5 минут
    
    # Автоматическая очистка при старте
    auto_cleanup_on_start: true
  
  # ============================================
  # Интеграция с Docker MCP Orchestrator
  # ============================================
  orchestrator:
    # Включить интеграцию с Orchestrator
    enabled: true
    
    # Путь к конфигурации Orchestrator
    config_path: "/path/to/docker-mcp-orchestrator/config/config.yaml"
    
    # Таймаут для операций Orchestrator (секунды)
    timeout: 60
    
    # Автоматический запуск нужных субагентов
    auto_start_subagents: true
    
    # Автоматическая остановка субагентов после выполнения
    auto_stop_subagents: true
    
    # Максимальное время ожидания запуска субагента (секунды)
    subagent_start_timeout: 30
  
  # ============================================
  # Настройки выполнения задач
  # ============================================
  execution:
    # Максимальное количество параллельных задач
    max_concurrent_tasks: 5
    
    # Таймаут выполнения одной задачи (секунды)
    task_timeout: 600  # 10 минут
    
    # Интервал проверки статуса задач (секунды)
    status_check_interval: 5
    
    # Автоматическая отмена зависших задач
    auto_cancel_stuck_tasks: true
    
    # Время для определения зависшей задачи (секунды)
    stuck_task_threshold: 1800  # 30 минут
  
  # ============================================
  # Кэширование
  # ============================================
  cache:
    # Включить кэширование
    enabled: true
    
    # TTL для кэшированных запросов (секунды)
    request_ttl: 3600  # 1 час
    
    # TTL для кэшированных результатов (секунды)
    results_ttl: 7200  # 2 часа
    
    # Максимальный размер кэша (количество записей)
    max_size: 1000
    
    # Тип хранилища кэша
    # Варианты: memory, redis, file
    storage_type: "memory"
    
    # Настройки Redis (если используется)
    redis:
      host: "localhost"
      port: 6379
      db: 0
      password: null
  
  # ============================================
  # Логирование
  # ============================================
  logging:
    # Уровень логирования
    # Варианты: DEBUG, INFO, WARNING, ERROR, CRITICAL
    level: "INFO"
    
    # Формат логов
    format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
    
    # Дата формат
    date_format: "%Y-%m-%d %H:%M:%S"
    
    # Файл для логов (null = только консоль)
    file: "logs/bridge.log"
    
    # Максимальный размер лог-файла (байты)
    max_file_size: 10485760  # 10 MB
    
    # Количество резервных копий лог-файлов
    backup_count: 5
    
    # Логировать все запросы и ответы
    log_requests: true
    log_responses: true
    
    # Логировать персональные данные (API ключи и т.д.)
    # ВНИМАНИЕ: Установите в false для production!
    log_sensitive_data: false
  
  # ============================================
  # Безопасность
  # ============================================
  security:
    # Включить валидацию запросов
    validate_requests: true
    
    # Включить санитизацию входных данных
    sanitize_inputs: true
    
    # Максимальная длина строковых полей
    max_string_length: 10000
    
    # Разрешенные символы в запросах (regex pattern)
    # null = разрешены все символы
    allowed_characters: null
    
    # Rate limiting (запросов в минуту)
    rate_limit:
      enabled: false
      requests_per_minute: 60
      burst_size: 10
  
  # ============================================
  # Мониторинг и метрики
  # ============================================
  monitoring:
    # Включить сбор метрик
    enabled: true
    
    # Экспорт метрик (prometheus, statsd, или null)
    metrics_backend: null
    
    # Endpoint для метрик (если используется HTTP)
    metrics_endpoint: "/metrics"
    
    # Метрики для отслеживания:
    # - request_count: количество запросов
    # - request_duration: время обработки запросов
    # - task_count: количество задач
    # - task_duration: время выполнения задач
    # - error_count: количество ошибок
    # - active_sessions: количество активных сессий
  
  # ============================================
  # Производительность
  # ============================================
  performance:
    # Размер пула соединений для HTTP клиента
    connection_pool_size: 10
    
    # Таймаут соединения (секунды)
    connection_timeout: 30
    
    # Включить сжатие ответов (gzip)
    enable_compression: true
    
    # Оптимизация JSON сериализации
    optimize_json: true
  
  # ============================================
  # Отладка и разработка
  # ============================================
  debug:
    # Режим отладки
    enabled: false
    
    # Сохранять промежуточные результаты
    save_intermediate_results: false
    
    # Путь для сохранения промежуточных результатов
    intermediate_results_path: "debug/results"
    
    # Подробное логирование операций
    verbose_logging: false
